<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador Pro - Marqueter铆a</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f6; margin: 0; display: flex; }
        .sidebar { width: 250px; background-color: #2c3e50; color: white; height: 100vh; padding: 20px; position: fixed; }
        .sidebar h1 { font-size: 1.2rem; text-align: center; border-bottom: 1px solid #34495e; padding-bottom: 15px; }
        .sidebar a { display: block; color: white; text-decoration: none; padding: 15px; border-radius: 8px; margin: 10px 0; transition: 0.3s; }
        .sidebar a:hover, .sidebar a.active { background-color: #34495e; transform: translateX(5px); }
        .sidebar a.active { background-color: #3498db; }

        .main-content { margin-left: 250px; flex-grow: 1; padding: 40px; }

        .quote-container { 
            max-width: 750px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 15px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
        }

        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; }
        .input-group input, .input-group select { 
            width: 100%; 
            padding: 12px; 
            border: 1px solid #ddd; 
            border-radius: 8px; 
            box-sizing: border-box; 
            font-size: 15px; 
        }

        .row { display: flex; gap: 15px; }
        
        .materials-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 15px; 
            background: #f0f7ff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #3498db;
            margin-bottom: 20px;
        }

        .btn-calc { 
            width: 100%; 
            padding: 15px; 
            background: #2ecc71; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            font-size: 18px; 
            cursor: pointer; 
            margin-top: 10px; 
            transition: 0.3s; 
            font-weight: bold;
        }

        .btn-calc:hover { background: #27ae60; transform: translateY(-2px); }

        #resultado { 
            margin-top: 25px; 
            padding: 20px; 
            border: 2px solid #3498db; 
            border-radius: 10px; 
            display: none; 
            background: #f0f7ff; 
        }

        .res-line { display: flex; justify-content: space-between; margin-bottom: 8px; color: #2c3e50; }
        .total-final { 
            font-size: 1.5em; 
            color: #27ae60; 
            border-top: 2px solid #2ecc71; 
            padding-top: 10px; 
            margin-top: 10px; 
            font-weight: bold; 
        }

        @media print {
            .sidebar, .btn-calc, .input-group, .materials-grid, h2, label { display: none !important; }
            .main-content { margin: 0; padding: 0; }
            .quote-container { box-shadow: none; border: none; }
            #resultado { border: none; background: white; display: block !important; }
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="logo"><h1>MARQUETERA</h1></div>
        <nav class="menu">
            <a href="index.html" class="menu-item"> Inicio</a>
            <a href="dashboard.html" class="menu-item"> Inventario</a>
            <a href="quotes.html" class="menu-item active"> Nueva Cotizaci贸n</a>
            <a href="history.html" class="menu-item"> Historial de Ventas</a>
        </nav>
    </aside>

    <main class="main-content">
        <div class="quote-container">
            <h2><i class="fas fa-calculator"></i> Nueva Cotizaci贸n</h2>
            
            <div class="row">
                <div class="input-group" style="flex:1">
                    <label>Ancho (cm)</label>
                    <input type="number" id="ancho" placeholder="Ej: 70">
                </div>
                <div class="input-group" style="flex:1">
                    <label>Largo (cm)</label>
                    <input type="number" id="largo" placeholder="Ej: 100">
                </div>
            </div>

            <label style="font-weight: bold; color: #34495e; display: block; margin-bottom: 10px;">
                <i class="fas fa-layer-group"></i> Selecci贸n de Materiales:
            </label>
            
            <div class="materials-grid">
                <div class="input-group">
                    <label style="font-size: 0.85em;">Vidrio / Espejo</label>
                    <select id="materialId" class="mat-selector">
                        <option value="">-- Principal --</option>
                    </select>
                </div>
                <div class="input-group">
                    <label style="font-size: 0.85em;">Respaldo (MDF/Triplex)</label>
                    <select id="materialRespaldoId" class="mat-selector">
                        <option value="">-- Ninguno --</option>
                    </select>
                </div>
                <div class="input-group">
                    <label style="font-size: 0.85em;">Passepartout</label>
                    <select id="materialExtraId" class="mat-selector">
                        <option value="">-- Ninguno --</option>
                    </select>
                </div>
                <div class="input-group">
    <label style="font-size: 0.85em; color: #1e3a8a; font-weight: 800;">
        <i class="fas fa-search"></i> Buscar Moldura (C贸digo)
    </label>
    <input type="text" 
           list="lista-molduras" 
           id="input-moldura" 
           class="form-control" 
           placeholder="Escribe c贸digo (Ej: K 2312)..." 
           oninput="sincronizarBuscadorMoldura(this.value)"
           style="margin-bottom: 5px; border: 2px solid #3498db; background: #fff; width: 100%; padding: 12px; border-radius: 8px; box-sizing: border-box;">
    
    <datalist id="lista-molduras"></datalist>

    <label style="font-size: 0.75em; opacity: 0.8;">Selecci贸n de respaldo (Lista):</label>
    <select id="materialOtroId" class="mat-selector">
        <option value="">-- Ninguno --</option>
    </select>
</div>

<div class="input-group">
    <label style="font-size: 0.85em;">Foam Board</label>
    <select id="materialFoamId" class="mat-selector">
        <option value="">-- Ninguno --</option>
    </select>
</div>

<div class="input-group">
    <label style="font-size: 0.85em;">Tela / Lona</label>
    <select id="materialTelaId" class="mat-selector">
        <option value="">-- Ninguno --</option>
    </select>
</div>

<div class="input-group" style="grid-column: span 2;">
    <label style="font-size: 0.85em;">Acabado Especial (Chapilla)</label>
    <select id="materialChapillaId" class="mat-selector">
        <option value="">-- Ninguno --</option>
    </select>
</div>
            <div class="input-group">
                <label>Mano de Obra ($)</label>
                <input type="number" id="manoObra" value="0">
            </div>

            <button class="btn-calc" onclick="procesarCotizacion()">
                <i class="fas fa-coins"></i> Calcular Precio Final
            </button>

            <div id="resultado">
                <h3 style="margin-top:0; color: #1a2a6c;"><i class="fas fa-file-invoice-dollar"></i> Resumen</h3>
                <div id="detalleObra"></div>
                <hr>
                
                <div class="res-line"><span>Materiales (Costo Base):</span> <span id="resMaterial">$ 0</span></div>
                <div class="res-line"><span>Mano de Obra:</span> <span id="resMO">$ 0</span></div>
                <div class="res-line total-final"><span>TOTAL VENTA:</span> <span id="resTotal">$ 0</span></div>

                <div id="containerAcciones"></div>
                
                <button class="btn-calc" style="background:#34495e; margin-top:20px;" onclick="window.print()">
                    <i class="fas fa-print"></i> Imprimir Cotizaci贸n
                </button>
            </div>
        </div>
    </main>

    <script src="js/api.js"></script>
    <script src="js/quotes.js"></script>
</body>
</html>
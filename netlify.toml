# SISTEMA DE GESTIÓN - MARQUETERÍA LA CHICA MORALES
# Archivo de Configuración de Despliegue - Versión 13.3.44
# Corrección: Eliminación de prefijo reservado en redirecciones según log de Netlify.

[build]
  # Carpeta donde están tus archivos HTML, CSS y JS front-end
  publish = "public"
  # Carpeta donde Netlify buscará el backend
  functions = "netlify/functions"

# --- REGLAS DE REDIRECCIÓN (Blindaje Anti-404 Actualizado) ---

# 1. Puente para la Función (Corregido: 'from' no debe empezar con /.netlify)
[[redirects]]
  from = "/functions/server/*"
  to = "/.netlify/functions/server/:splat"
  status = 200
  force = true

# 2. Ruta específica para facturas (Respetado)
[[redirects]]
  from = "/api/invoices"
  to = "/.netlify/functions/server/invoices"
  status = 200
  force = true

# 3. Comodín General de API (Respetado)
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/server/:splat"
  status = 200
  force = true

# 4. Manejo de SPA (Mantiene las rutas navegables)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
  